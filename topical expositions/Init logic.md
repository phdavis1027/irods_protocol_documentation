When a client wants to start up a connection with the iRODS server, it begins by sending a MsgHeader_PI of type RODS_CONNECT with errorLen, bsLen, and intInfo set to 0. As the body of this message, it then sends a StartupPack_PI with the following fields: 
- irodsProt: Indicates which protocol encoding the client is requesting to use for the session. Note that the initial handshake is always in XML. Valid values are:
	-  0, meaning NATIVE_PROT, the binary encoding. 
	- 1, meaning XML_PROT. 
 Sending any other value will  result in the server replying with an error (I think).
- reconnFlag: Indicates whether, on failed connection, the server should attempt to reconnect.
- connectCnt:  This is a weird one. The server checks to make sure that this value is no more than 7, but I have no data that gives clues about what might make this value higher. In a StartupPack, it's 0. On the other hand, in [this](https://irods.org/uploads/2009/iRODS-refmanual.pdf) resources, it's described as "\[pointer\] to Connection structure."
- clientUser: rodsuser name in the zone to which the client is sending the request. 
- proxyUser: rodsuser name in the proxy zone, if using one. If not, this value is the same as clientUser.
- clientZone: name of the zone to which the client is sending the request.
- proxyZone: name of the proxy zone, if using one. If not, this value is the same as clientZone.
- relVersion: the string "rods" (I think) followed by the semantic versioning number of the iRODS version being used by the client.
- apiVersion: this is something with semantic versioning I think, which I don't understand. 
- option: an optional field. iCommand sends the command executed as a string.

Once the server has determined that all these values are valid, it will respond with a header with type RODS_VERSION. Again, errorLen, bsLen, and intInfo are set 0. The body of this message is a RodsVersion_PI. This is the only valid protocol element which can be sent after a header with type RODS_VERSION. The RodsVersion_PI has the following fields:
- relVersion: the string "rods" (I think) followed by the semantic versioning number of the iRODS version being used by the server.
- apiVersion: this is something with semantic versioning I think, which I don't understand.
- reconnPort: the port on which to attempt reconnection in the case of a failed connection. Set to zero if the client sent a StartupPack_PI with reconnFlag set to 0.
- reconnAddr: the IPv4 (I think) address on which to attempt reconnection in the case of a failed connection. Left null if the client sent a StartupPack_PI with reconnFlag set to 0.
- cookie: always set to 400. Only used by Jargon. 

Assuming that the client is configured for the native iRODS authentication scheme, the client then sends a header with type RODS_API_REQ. ErrorLen and bsLen are set to 0, but intInfo is set to 703 for AUTH_REQUEST_AN. This message has no body. 

The server responds to the auth request by sending a header with RODS_API_REPLY with errorLen, bsLen, and intInfo set to 0. The body of this message is an authRequestOut_PI with a single field:
- challenge: a dynamically generated challenge string.

The client then responds with a header of type RODS_API_REQ. ErrorLen and bsLen are set to 0, and intInfo is set to 704 for AUTH_RESPONSE_AN. The body of this message is an authResponseInp_PI with two names:
- response: a string generated by hashing the concatenation of the challenge string sent by the server with the rodsuser's password.
- username: a string of the format RODSUSER#ZONE.

If the response and the username are both valid, then the server will respond with a header of type RODS_API_REPLY with all fields set to 0 and no message body. 

If the client sends an invalid username, the connection procedure is the same until the client sends the authResponseInp_PI, at which point the server will respond with a header of type RODS_API_REPLY and intInfo -827000, the error code for CAT_INVALID_USER. The client will then respond with a header of type RODS_DISCONNECT with all other fields set to 0. Similarly, if the client sends an invalid password for the rodsuser, the server will send a header with intInfo -826000, the error code for CAT_INVALID_AUTHENTICATION. Then the client will respond with a RODS_DISCONNECT. Finally, if the client sends a non-existent zone, then the server will act as if an invalid username has been sent and respond with CAT_INVALID_USER.

Once all of these messages are exchanged successfully, a connection has been established and will be maintained until either the client or the server dispose of the connection. 

